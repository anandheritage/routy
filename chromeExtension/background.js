!function(e){function t(n){if(r[n])return r[n].exports;var s=r[n]={exports:{},id:n,loaded:!1};return e[n].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var s=r(2),i=n(s);window.hm=new i.default},function(e,t){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(){n(this,e),this.events={change:[]},this.services=localStorage.services?JSON.parse(localStorage.services):[],this.preferences=localStorage.preferences?JSON.parse(localStorage.preferences):{service_url:null,namespaces:null,url_filters:null},this.updateFilters(),this.urlFilters={urls:this.filters},this.extraInfoSpec=["requestHeaders","blocking"],chrome.runtime.onMessage.addListener(this.onMessageHandler.bind(this))}return s(e,[{key:"updateFilters",value:function(){this.filters=[],null!=this.preferences.url_filters&&""!=this.preferences.url_filters&&this.filters.push("*://"+this.preferences.url_filters+"/*"),this.urlFilters={urls:this.filters}}},{key:"setServices",value:function(e){this.services=e,localStorage.services=JSON.stringify(e)}},{key:"getServices",value:function(){return this.services}},{key:"setUrlFilters",value:function(e){this.urlFilters=e,this.emit("change")}},{key:"getUrlFilters",value:function(){return this.urlFilters}},{key:"setExtraInfoSpec",value:function(e){this.extraInfoSpec=e,this.emit("change")}},{key:"getPreferences",value:function(){return this.preferences}},{key:"setPreferences",value:function(e){this.preferences=e,this.updateFilters(),localStorage.preferences=JSON.stringify(e),this.emit("change")}},{key:"getExtraInfoSpec",value:function(){return this.extraInfoSpec}},{key:"onMessageHandler",value:function(e,t,n){if("bgs/configurationHandler"===e.id){var s=e.action,i=e.parameters,a=e.expectingResponse;if(s){var u=this[s].apply(this,r(i));a&&n&&n(u)}}}},{key:"on",value:function(e,t){this.events[e]&&this.events[e].push(t)}},{key:"emit",value:function(e){if(this.events[e])for(var t=0;t<this.events[e].length;t++)this.events[e][t]()}}]),e}();t.default=i},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(1),u=n(a),o=function(){function e(){s(this,e),this.config=new u.default,this.eventListener=this.onBeforeSendHeadersListener.bind(this),this.config.on("change",this.addListeners.bind(this)),this.addListeners()}return i(e,[{key:"removeListeners",value:function(){chrome.webRequest.onBeforeSendHeaders.removeListener(this.eventListener)}},{key:"addListeners",value:function(){this.removeListeners(),chrome.webRequest.onBeforeSendHeaders.addListener(this.eventListener,this.config.getUrlFilters(),this.config.getExtraInfoSpec())}},{key:"onBeforeSendHeadersListener",value:function(e){for(var t=e.requestHeaders,r=this.config.getServices(),n=0;n<r.length;n++){var s=r[n];s.enabled&&t.push({name:"hprop-"+s.name,value:s.value})}return{requestHeaders:t}}}]),e}();t.default=o}]);